(()=>{var e={838:function(e){var t;t=()=>(()=>{"use strict";var e={523:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emulateEvent=t.addMultipleEventHandlers=t.isObject=t.isArray=t.isLink=void 0,t.isLink=function(e){return/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(e)},t.isArray=function(e){return null!==e&&"Array"===e.constructor.name},t.isObject=function(e){return null!==e&&"Object"===e.constructor.name},t.addMultipleEventHandlers=function(e,t,n){e.forEach((function(e){e.addEventListener(t,(function(e){n(e)}))}))},t.emulateEvent=function(e,t){var n=document.createEvent("Events");n.initEvent(t,!0,!1),e.dispatchEvent(n)}},298:function(e,t){var n=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))};function o(e){var t="\n/* generated by src/ts/lib/themes.ts generateCSSCode() function */\n    ";return Object.keys(e).forEach((function(o){var i=e[o].selector,r=n([],Object.keys(e[o].properties),!0).map((function(t){return"".concat(t,": ").concat(e[o].properties[t],";\n")})).join("");t+="\n".concat(i," {\n    ").concat(r,"}\n")})),t}function i(e,t){var n=document.head.querySelector(t);if(n)n.innerHTML=e;else{var o=document.createElement("style"),i=t.split("=")[0].replace(/\[+/gm,""),r=t.split("=")[1].replace(/(\]|\")+/gm,"");o.type="text/css",o.setAttribute(i,r),o.innerHTML=e,document.head.appendChild(o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateTheme=t.updateThemeCSS=t.generateCSSCode=void 0,t.generateCSSCode=o,t.updateThemeCSS=i,t.updateTheme=function(e){if(/css\/themes\/[a-zA-Z\-0-9]+\.css/.test(e)){var t=e,n=document.createElement("link");n.href=t,n.rel="stylesheet",document.head.appendChild(n)}else{var r=function(e){return{dracula:{container:{selector:".json2html-container",properties:{background:"#282a36"}},spoilerToggle:{selector:".json2html-spoiler-toggle--collapsed, .json2html-spoiler-toggle--uncollapsed",properties:{color:"#ffffff"}},key:{selector:".json2html-key",properties:{color:"#8be9fd"}},valueTypeBoolean:{selector:".json2html-type__boolean",properties:{color:"#bd93f9"}},valueMinusSign:{selector:".json2html-value__minus-sign",properties:{color:"#ff79c6"}},valueTypeNumber:{selector:".json2html-type__number",properties:{color:"#bd93f9"}},valueTypeString:{selector:".json2html-type__string",properties:{color:"#f1fa8c"}},valueTypeStringLink:{selector:".json2html-type__string a, .json2html-type__string a:visited",properties:{color:"#ff79c6"}},valueTypeNull:{selector:".json2html-type__null",properties:{color:"#6272a4"}},valueTypeUndefined:{selector:".json2html-type__undefined",properties:{color:"#ffb86c"}},valueComplexItemSignature:{selector:".json2html-type__array, .json2html-type__object",properties:{color:"#f8f8f2"}},collapseAllToggle:{selector:".json2html-collapse-all-toggle",properties:{color:"white"}}}}[e]}(e);i(o(r),'[data-style-origin="json2html"]')}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}var o={};return(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.json2html=void 0;var t=n(523),i=n(298);function r(e,t){t=t||e.parentElement.querySelector(".".concat("json2html-collapse-all-toggle"));var n="uncollapsed"==e.className.split("--")[1]?"collapse":"uncollapse";t&&(t.textContent="(".concat(n," all)"))}function s(e){var n=Object.keys(e.parsedJSON),o=[],i=document.createElement("div");return i.classList.add("json2html-container"),n.forEach((function(n){if((0,t.isArray)(e.parsedJSON[n])||(0,t.isObject)(e.parsedJSON[n])){var i=function(e){var n=e.depth+1,o=Object.values(e.itemValue),i=o.length>e.groupBigArrayItemsBy,a=i?function(e,t){for(var n=0,o={},i=function(i){var r=i*t>e.length?e.length:i*t,s="[".concat(n," ... ").concat(r-1,"]"),a=e.slice(n,r),l=[];a.forEach((function(e,t){l[t+n]=e})),n!==r&&(o[s]=l),n=i*t},r=0;r<=Math.ceil(e.length/t);r++)i(r);return o}(o,e.groupBigArrayItemsBy):e.itemValue,l=Object.values(a).length,c=s({depth:n,parsedJSON:a,renderNestedLength:e.renderNestedLength,highlightLinks:e.highlightLinks,openLinksInNewTab:e.openLinksInNewTab,collapseAll:e.collapseAll,showLevel:e.showLevel,showTypeOnHover:e.showTypeOnHover,groupBigArrayItemsBy:e.groupBigArrayItemsBy,isGroupItem:i});c.classList.add("json2html-nested-value");var h=document.createElement("div");h.classList.add("json2html-complex-pair"),h.setAttribute("data-tree-level","".concat(n));var u=document.createElement("span");u.textContent="▶",!0===e.collapseAll?(u.classList.add("json2html-spoiler-toggle--collapsed"),c.setAttribute("hidden","")):n<=e.showLevel?u.classList.add("json2html-spoiler-toggle--uncollapsed"):(u.classList.add("json2html-spoiler-toggle--collapsed"),c.setAttribute("hidden",""));var p=document.createElement("span");p.textContent=e.keyName+": ",p.classList.add("json2html-key");var d=document.createElement("span");d.textContent=e.itemValue.constructor.name,l>0&&(0,t.addMultipleEventHandlers)([u,p,d],"click",(function(e){var t="json2html-spoiler-toggle--collapsed",n="json2html-spoiler-toggle--uncollapsed";u.classList.contains(t)?(u.classList.remove(t),u.classList.add(n),c.removeAttribute("hidden")):(u.classList.add(t),u.classList.remove(n),c.setAttribute("hidden","")),r(u)}));var y,f,g=e.itemValue.constructor.name,v=g[0].toLowerCase()+g.slice(1);if(!0===e.renderNestedLength)if((0,t.isArray)(e.itemValue)){var m=e.itemValue.length;if(e.isGroupItem){var b=Number(e.keyName.split(" ... ")[0].replace("[",""));m=Number(e.keyName.split(" ... ")[1].replace("]",""))-b+1}var x=0==m?"empty":m,w="empty"==x?"":1==x?" item":" items";d.textContent+=" (".concat(x).concat(w,")")}else(0,t.isObject)(e.itemValue)&&0===Object.keys(e.itemValue).length&&(d.textContent+=" (empty)");return d.classList.add("json2html-type__"+v),Object.values(a).length>0&&h.appendChild(u),h.appendChild(p),h.appendChild(d),Object.values(a).length>0&&(y=a,f=!1,Object.values(y).forEach((function(e){null!==e&&((0,t.isObject)(e)||(0,t.isArray)(e))&&(f=!0)})),f)&&function(e){var n="json2html-collapse-all-toggle",o=e.renderIn.querySelector("".concat(n)),i=o||document.createElement("span");o||(i.className=n),r(e.targetSpoiler,i),i.addEventListener("click",(function(n){e.renderIn.querySelectorAll("."+e.targetSpoiler.className).forEach((function(e){(0,t.emulateEvent)(e,"click"),r(e)}))})),o||e.renderIn.appendChild(i)}({targetSpoiler:u,renderIn:h,collapsed:e.collapseAll,nestedObject:a}),Object.values(a).length>0&&h.appendChild(c),h}({depth:e.depth,keyName:n,itemValue:e.parsedJSON[n],renderNestedLength:e.renderNestedLength,highlightLinks:e.highlightLinks,openLinksInNewTab:e.openLinksInNewTab,collapseAll:e.collapseAll,showLevel:e.showLevel,showTypeOnHover:e.showTypeOnHover,groupBigArrayItemsBy:e.groupBigArrayItemsBy,isGroupItem:e.isGroupItem});o.push(i)}else{var a=function(e){var n=document.createElement("div");n.classList.add("json2html-pair");var o=document.createElement("span");o.textContent=e.keyName+": ",o.classList.add("json2html-key");var i=document.createElement("span");if("number"==typeof e.itemValue&&e.itemValue<0){var r=document.createElement("span");r.classList.add("json2html-value__minus-sign"),r.textContent="-",i.appendChild(r),i.innerHTML+=Math.abs(e.itemValue)}else i.textContent=function(e){var t="string"==typeof e,n=e;return null==e&&(n="".concat(e)),t&&(n='"'.concat(e,'"')),n}(e.itemValue);if(!0===e.showTypeOnHover){var s=null==e.itemValue?"null":typeof e.itemValue;!0===e.highlightLinks&&(0,t.isLink)(e.itemValue)&&(s="string (clickable link)"),i.setAttribute("title",s)}if(!0===e.highlightLinks&&(0,t.isLink)(e.itemValue)){var a=document.createElement("a");!0===e.openLinksInNewTab&&a.setAttribute("target","_blank"),a.href=e.itemValue,a.textContent='"'.concat(e.itemValue,'"'),i.textContent="",i.appendChild(a)}return i.classList.add("json2html-value"),i.classList.add(function(e){return"json2html-type__"+(null==e||"undefined"==e?e:typeof e)}(e.itemValue)),n.appendChild(o),n.appendChild(i),n}({keyName:n,itemValue:e.parsedJSON[n],highlightLinks:e.highlightLinks,openLinksInNewTab:e.openLinksInNewTab,showTypeOnHover:e.showTypeOnHover});o.push(a)}})),o.forEach((function(e){i.appendChild(e)})),i}e.json2html=function(e){var t;e.rootName=e.rootName||"json",e.renderNestedLength=0!=e.renderNestedLength,e.highlightLinks=0!=e.highlightLinks,e.openLinksInNewTab=0!=e.openLinksInNewTab,e.collapseAll=1==e.collapseAll,e.showLevel=e.showLevel||1,e.showTypeOnHover=0!=e.showTypeOnHover,e.theme=e.theme||"andromeda",e.groupBigArrayItemsBy=e.groupBigArrayItemsBy<=25?25:e.groupBigArrayItemsBy||100,(0,i.updateTheme)(e.theme);try{var n=JSON.parse(e.json);return s({depth:0,parsedJSON:(t={},t[e.rootName]=n,t),renderNestedLength:e.renderNestedLength,highlightLinks:e.highlightLinks,openLinksInNewTab:e.openLinksInNewTab,collapseAll:e.collapseAll,showLevel:e.showLevel,showTypeOnHover:e.showTypeOnHover,groupBigArrayItemsBy:e.groupBigArrayItemsBy,isGroupItem:!1})}catch(t){e.onError(t)}}})(),o})(),e.exports=t()}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}(()=>{"use strict";function e(e){return{carbon:"rgba(14, 14, 14, 1)",darkRed:"rgba(38, 12, 12, 1)",brightRed:"rgba(114, 6, 6, 1)",darkBlue:"rgba(12, 16, 38, 1)",brightBlue:"rgba(9, 12, 104, 1)",darkGreen:"rgba(12, 38, 12, 1)",brightGreen:"rgba(6, 114, 6, 1)"}[e]}function t(e,t){return t=Math.max(0,Math.min(t,1)),e.split(", ").map((function(e,n){return 3==n&&(e=t+")"),e})).join(", ")}function o(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function i(e,t,n){return void 0===n&&(n=0),e.x>=t.position.x-n&&e.x<=t.position.x+t.size.width+n&&e.y>=t.position.y-n&&e.y<=t.position.y+t.size.height+n}function r(e,t,n,o,i){return Math.pow(e-n,2)+Math.pow(t-o,2)<=Math.pow(i,2)}function s(e,t,n,o,i,r,s,a){switch(e.fillStyle=s,e.strokeStyle=a,e.beginPath(),r){case"up":e.moveTo(t,n),e.lineTo(t-i/2,n+o),e.lineTo(t+i/2,n+o);break;case"down":e.moveTo(t,n),e.lineTo(t-i/2,n-o),e.lineTo(t+i/2,n-o);break;case"left":e.moveTo(t,n),e.lineTo(t+o,n-i/2),e.lineTo(t+o,n+i/2);break;case"right":e.moveTo(t,n),e.lineTo(t-o,n-i/2),e.lineTo(t-o,n+i/2)}e.closePath(),e.stroke(),e.fill()}function a(e){return"".concat(e.x,",").concat(e.y)}const l=function(){function e(e,t){this.uniqueIDs=new Set,this.parent=e;var n=document.createElement("canvas");if(n.width=this.parent.width,n.height=this.parent.height,n.classList.add(t),this.body=n,this.context=n.getContext("2d"),!this.context)throw new Error("Failed to get 2D drawing context.");this.children=[]}return e.prototype.getUniqueID=function(){var e;do{e=Math.floor(1e4*Math.random())+1}while(this.uniqueIDs.has(e));return this.uniqueIDs.add(e),e},e.prototype.fill=function(e){this.context.fillStyle=e,this.context.fillRect(0,0,this.parent.width,this.parent.height)},e.prototype.appendChild=function(e){e.id=this.getUniqueID(),this.children.push(e)},e.prototype.render=function(){this.context.clearRect(0,0,this.parent.width,this.parent.height);for(var e=0,t=this.children;e<t.length;e++)t[e].renderAt(this.context)},e}();const c=function(){function e(e,t,n){this.width=t,this.height=n,this.background=new l(this,"app-canvas__background"),this.foreground=new l(this,"app-canvas__foreground");var o=document.createElement("div");o.classList.add("app-canvas__container"),o.appendChild(this.background.body),o.appendChild(this.foreground.body),o.style.width="".concat(t,"px"),o.style.height="".concat(n,"px"),document.querySelector(e).appendChild(o)}return e.prototype.addEventListener=function(e,t){this.foreground.body.addEventListener(e,(function(e){t(e)}))},e.prototype.processIntersectionsWithMouse=function(){var e=this;this.addEventListener("mousedown",(function(t){if(e.isMousePressed=!0,t instanceof MouseEvent)for(var n=o(e.foreground.body,t),i=0,s=e.foreground.children;i<s.length;i++)for(var a=0,l=s[i].ports.getAll();a<l.length;a++){var c=l[a],h=c.connectionPoint.point;r(n.x,n.y,h.x,h.y,c.r)&&c.dispatchEvent("click",{target:c})}})),this.addEventListener("mouseup",(function(t){if(e.isMousePressed=!1,t instanceof MouseEvent)for(var n=o(e.foreground.body,t),r=0,s=e.foreground.children;r<s.length;r++){var a=s[r];i(n,a)&&a.dispatchEvent("mouseup",{target:a})}})),this.addEventListener("mousemove",(function(t){if(t instanceof MouseEvent){for(var n=o(e.foreground.body,t),i={x:0,y:0},s=0,a=e.foreground.children;s<a.length;s++){var l=a[s];if(n.x>=l.position.x&&n.x<=l.position.x+l.size.width&&n.y>=l.position.y&&n.y<=l.position.y+l.size.height){var c={target:l,mousePosition:n,offset:{}};l.dispatchEvent("mousemove",c),l.eventStates.mousemove=!0,l.eventStates.mouseover||(l.dispatchEvent("mouseover",c),l.eventStates.mouseover=!0,l.eventStates.mouseout=!1),e.isMousePressed&&(c.offset={x:n.x-i.x,y:n.y-i.y},l.dispatchEvent("drag",c),i=n,l.eventStates.drag=!0),!e.isMousePressed&&l.eventStates.drag&&(l.dispatchEvent("dragend",c),l.eventStates.drag=!1)}else l.eventStates.mouseout||(l.dispatchEvent("mouseout",{target:l}),l.eventStates.mouseout=!0,l.eventStates.mouseover=!1),l.eventStates.mousemove=!1}for(var h=0,u=e.foreground.children;h<u.length;h++)for(var p=0,d=(l=u[h]).ports.getAll();p<d.length;p++){var y=d[p],f=y.connectionPoint.point;r(n.x,n.y,f.x,f.y,y.hoverR)?y.eventStates.hoveron||(y.dispatchEvent("hoveron",{target:y}),y.eventStates.hoveron=!0,y.eventStates.hoveroff=!1):y.eventStates.hoveroff||(y.dispatchEvent("hoveroff",{target:y}),y.eventStates.hoveroff=!0,y.eventStates.hoveron=!1),r(n.x,n.y,f.x,f.y,2*y.r)?y.eventStates.mouseover||(y.dispatchEvent("mouseover",{target:y}),y.eventStates.mouseover=!0,y.eventStates.mouseout=!1):y.eventStates.mouseout||(y.dispatchEvent("mouseout",{target:y}),y.eventStates.mouseout=!0,y.eventStates.mouseover=!1)}}}))},e}(),h=function(){function e(e,t,n,o,i){this.x=e,this.y=t,this.r=n,this.color=o,this.up=null,this.down=null,this.left=null,this.right=null,this.isMidlineNode=i}return e.prototype.renderAt=function(e){e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI,!1),e.fillStyle=this.color,e.fill(),e.closePath()},e}();var u=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},p=function(){function e(e){this.parent=e.parent,this.midline={x:0,y:0};var t=this.generateSimpleGridPoints();this.nodes=this.createGraphFrom(t),this.lastPathData=null,this.style={graphNodeRadius:e.graphNodeRadius,graphLineColor:e.graphLineColor,graphLineThickness:e.graphLineThickness,graphNodeColor:e.graphNodeColor}}return e.prototype.generateSimpleGridPoints=function(){var e=function(e,t){var n=t.x,o=t.y,i=e.size,r=i.width,s=i.height,a=r/2,l=s/2,c=e.style.margin;return{centerPoint:{x:n+a,y:o+l},topCenterPoint:{x:n+a,y:o-c},leftCenterPoint:{x:n-c,y:o+l},bottomCenterPoint:{x:n+a,y:o+s+c},rightCenterPoint:{x:n+r+c,y:o+l},leftTopPoint:{x:n-c,y:o-c},leftBottomPoint:{x:n-c,y:o+s+c},rightTopPoint:{x:n+r+c,y:o-c},rightBottomPoint:{x:n+r+c,y:o+s+c}}},t=function(e,t){return t.map((function(t){return{x:t,y:e}}))},n=[],o=this.parent.endPoints[0],r=this.parent.endPoints[1],s=e(o.parent,o.parent.position),a=e(o.parent,{x:o.parent.position.x,y:r.parent.position.y}),l=e(r.parent,r.parent.position),c=e(r.parent,{x:r.parent.position.x,y:o.parent.position.y}),h=s.centerPoint,p=l.centerPoint,d=Math.round((h.x+p.x)/2),y=Math.round((h.y+p.y)/2);this.midline.x=d,this.midline.y=y;var f,g=u(u(u([],(f=d,[s.leftTopPoint.y,s.centerPoint.y,s.leftBottomPoint.y,y,a.leftTopPoint.y,a.centerPoint.y,a.leftBottomPoint.y].map((function(e){return{x:f,y:e}}))),!0),t(y,[s.leftTopPoint.x,s.centerPoint.x,s.rightBottomPoint.x]),!0),t(y,[l.leftTopPoint.x,l.centerPoint.x,l.rightBottomPoint.x]),!0);delete s.centerPoint,delete l.centerPoint,n.push.apply(n,Object.values(s)),n.push.apply(n,Object.values(a)),n.push.apply(n,Object.values(l)),n.push.apply(n,Object.values(c)),n.push.apply(n,g);var v=n.filter((function(e){var t=i(e,o.parent,o.parent.style.margin-1),n=i(e,r.parent,r.parent.style.margin-1);if(!t&&!n)return e}));return v.sort((function(e,t){return e.x===t.x?e.y-t.y:e.x-t.x})),v},e.prototype.createGraphFrom=function(e){var t=this,n={},o=this.parent.endPoints,r=o[0].parent,s=o[1].parent,a=function(e){return"".concat(e.x,",").concat(e.y)};function l(e,t){var n={x:(e.x+t.x)/2,y:(e.y+t.y)/2};return!i(n,r)&&!i(n,s)}e.forEach((function(e){e.x==t.midline.x||e.y==t.midline.y?n["".concat(e.x,",").concat(e.y)]=new h(e.x,e.y,2,"magenta",!0):n["".concat(e.x,",").concat(e.y)]=new h(e.x,e.y,2,"orange",!1)}));for(var c=function(e,t){var n={};return t.forEach((function(e){var t=e.y;n[t]||(n[t]=[]),n[t].push(e)})),Object.values(n)}(0,e),u=0;u<c.length;u++)for(var p=c[u],d=function(e){var t=p[e],o="".concat(t.x,",").concat(t.y);if(u>0){var i=c[u-1].find((function(e){return e.x===t.x}));i&&l(t,i)&&(n[o].up=n[a(i)])}if(u<c.length-1){var r=c[u+1].find((function(e){return e.x===t.x}));r&&l(t,r)&&(n[o].down=n[a(r)])}if(e>0){var s=p[e-1];l(t,s)&&(n[o].left=n[a(s)])}if(e<p.length-1){var h=p[e+1];l(t,h)&&(n[o].right=n[a(h)])}},y=0;y<p.length;y++)d(y);return n},e.prototype.recalcPathCostByHeuristic=function(e,t,n,o){var i=0,r=o.currentNode,s=o.neighborNode,l=o.newDistance,c=o.newTurns,h=o.newMidlineNodesCount,u=this.parent.endPoints[0].letter,p=this.parent.endPoints[1].letter,d=a(r)==a(t)&&s.isMidlineNode,y=r.isMidlineNode&&s.isMidlineNode,f=r.isMidlineNode&&a(s)==a(n);return"orthogonal"===e?i=u===p?l+100*c:l+10*c-7*h+(d||y||f?-1e3:3e3):"shortest"===e&&(i=l+15*c),i},e.prototype.findPathBetween=function(e,t,n){var o=this.nodes["".concat(e.x,",").concat(e.y)],i=this.nodes["".concat(t.x,",").concat(t.y)];if("straight"===n)return[o,i];if(!o||!i)return console.error("Путь невозможен: точки старта или конца пути не найдены в графе!"),[];for(var r=[{node:o,path:[o],distance:0,turns:0,direction:null,cost:0,midlineNodesCount:0}],s={},l={up:"down",down:"up",left:"right",right:"left"};r.length>0;){r.sort((function(e,t){return e.cost-t.cost}));var c=r.shift(),h=c.node,p=c.path,d=c.distance,y=c.turns,f=c.direction,g=(c.cost,c.midlineNodesCount);if(a(h)===a(i))return this.lastPathData=c,p;if(!(y>4))for(var v={up:h.up,down:h.down,left:h.left,right:h.right},m=0,b=Object.entries(v);m<b.length;m++){var x=b[m],w=x[0],L=x[1];if(L){var P=a(L);if(s[P]=(s[P]||0)+1,s[P]>5)continue;if(null!==f&&w===l[f])continue;var C=d+Math.abs(L.x-h.x)+Math.abs(L.y-h.y),T=null===f||f===w?y:y+1,S=c.node.isMidlineNode?g+1:g;r.push({node:L,path:u(u([],p,!0),[L],!1),distance:C,turns:T,direction:w,midlineNodesCount:S,cost:this.recalcPathCostByHeuristic(n,o,i,{currentNode:h,neighborNode:L,newDistance:C,newTurns:T,newMidlineNodesCount:S})})}}}return console.error("Путь не найден."),[]},e.prototype.renderAt=function(e){if(!(Object.values(this.nodes).length<2)){e.strokeStyle=this.style.graphLineColor,e.lineWidth=this.style.graphLineThickness;var t=Object.values(this.nodes);t.forEach((function(t){t.down&&(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(t.down.x,t.down.y),e.stroke(),e.closePath()),t.right&&(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(t.right.x,t.right.y),e.stroke(),e.closePath())})),t.forEach((function(t){t.renderAt(e)}))}},e}();const d=p,y=function(){function e(e,t,n){this.endPoints=[e,t],this.graph=new d({parent:this,graphNodeRadius:2,graphNodeColor:"orange",graphLineColor:"rgba(255, 255, 255, 0.1)",graphLineThickness:1}),this.method=JSON.parse(localStorage.getItem("connectionMethod"));var o=this.endPoints[0].connectionPoint.point,i=this.endPoints[1].connectionPoint.point,r="straight";"shortest path"===this.method?r="shortest":"straight line"===this.method?r="straight":"orthogonal (elbow)"===this.method&&(r="orthogonal"),this.points=this.graph.findPathBetween(o,i,r),this.color=n}return e.prototype.renderConnecterSegmentAt=function(e,t,n){if(!this.endPoints[0]||!this.endPoints[1])return console.error("Один из портов пустой! Массив текущих значений: ",this.endPoints),!1;e.strokeStyle=this.color,e.lineWidth=1;var o=function(e){var t=[e.connectionPoint.point],n=e.parent;return"A"===e.letter?t.push({x:n.position.x-1,y:n.position.y+n.size.height/2}):"B"===e.letter?t.push({x:n.position.x+n.size.width/2,y:n.position.y-1}):"C"===e.letter?t.push({x:n.position.x+n.size.width+1,y:n.position.y+n.size.height/2}):"D"===e.letter&&t.push({x:n.position.x+n.size.width/2,y:n.position.y+n.size.height+1}),t},i=this.endPoints.map((function(e){return o(e)}));i.forEach((function(n){var o=n[0],i=n[1];"dashed"===t&&(e.setLineDash([5,5]),e.lineDashOffset=5),"dots"==t&&e.setLineDash([2,2]),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(i.x,i.y),e.moveTo(o.x,o.y),e.stroke(),e.closePath(),"solid"!==t&&"dashed"!==t&&"dots"!==t||e.setLineDash([])}));var r={A:"right",B:"down",C:"left",D:"up"};if(n)for(var a=0,l=this.endPoints;a<l.length;a++){var c=l[a];if("slave"==c.role){var h=o(c)[1];s(e,h.x,h.y,8,8,r[c.letter],this.color,this.color)}}},e.prototype.renderSegmentsAt=function(e,t){var n=!0;e.strokeStyle=this.color,e.lineWidth=1,e.beginPath(),"dashed"===t&&e.setLineDash([5,5]),"dots"==t&&e.setLineDash([2,2]);for(var o=0;o<this.points.length;o++){var i=this.points[o];n?(e.moveTo(i.x,i.y),n=!1):e.lineTo(i.x,i.y)}e.stroke(),e.closePath(),"dashed"!==t&&"dots"!==t||e.setLineDash([])},e.prototype.renderAt=function(e){var t=JSON.parse(localStorage.getItem("renderGrid")),n=JSON.parse(localStorage.getItem("renderLinePointer")),o=JSON.parse(localStorage.getItem("lineStyle"));this.renderSegmentsAt(e,o),this.renderConnecterSegmentAt(e,o,n),t&&this.graph.renderAt(e)},e}(),f=function(){function e(){this.events={},this.eventStates={mouseout:!1,mouseover:!1,mouseup:!0,mousedown:!1,mousemove:!1,hoveron:!1,hoveroff:!1,drag:!1}}return e.prototype.addEventListener=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},e.prototype.dispatchEvent=function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))},e}();var g,v=(g=function(e,t){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},g(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});const m=function(e){function t(t){var n=e.call(this)||this;return n.connectionPoint={point:{x:t.x,y:t.y},angle:t.angle},n.letter=t.letter,n.parent=t.parent,n.r=t.r,n.hoverR=10*n.r,n.isBusy=!1,n.endPoint=null,n.connection=null,n.style={visibility:!1,fillColor:"rgba(25, 25, 25, 1)",borderColor:"rgba(55, 55, 55, 1)",borderThickness:0},n.role=null,n}return v(t,e),t.prototype.connectTo=function(e){this.endPoint=e,e.endPoint=this,this.isBusy=!0,e.isBusy=!0,null===this.role&&null===e.role?(this.role="master",e.role="slave"):this.role="slave"===e.role?"master":"slave",this.parent.lastConnectionWith=e.parent.id,this.endPoint.parent.lastConnectionWith=this.parent.id,this.connection=new y(this,this.endPoint,"rgba(255, 255, 255, 0.5)"),this.endPoint.connection=this.connection},t.prototype.reconnect=function(){this.connection=new y(this,this.endPoint,"rgba(255, 255, 255, 0.5)"),this.endPoint.connection=this.connection},t.prototype.disconnect=function(){var e=this.endPoint;return this.connection=null,this.endPoint.connection=null,this.endPoint.endPoint=null,this.endPoint=null,this.isBusy=!1,this.role=null,e},t.prototype.renderAt=function(e){null!==this.connection&&this.connection.renderAt(e),this.style.visibility&&function(e,t,n,o,i,r){e.beginPath(),e.arc(t,n,o,0,2*Math.PI,!1),e.lineWidth=1,e.fillStyle=i,e.strokeStyle=r,e.fill(),e.stroke(),e.closePath()}(e,this.connectionPoint.point.x,this.connectionPoint.point.y,this.r,this.isBusy?"rgba(0, 155, 155, 1)":this.style.fillColor,this.isBusy?"white":this.style.borderColor)},t}(f),b=function(){function e(e){this.ports=new Map(Object.entries(e))}return e.prototype.moveAll=function(e,t){var n=this.getAll();n.forEach((function(n){n.connectionPoint.point.x+=e,n.connectionPoint.point.y+=t})),n.filter((function(e){return e.isBusy})).forEach((function(e){return e.reconnect()}))},e.prototype.getPort=function(e){return this.ports.get(e)},e.prototype.getAll=function(){return Array.from(this.ports.values())},e.prototype.hideAll=function(){this.getAll().forEach((function(e){return e.style.visibility=!1}))},e.prototype.showAll=function(){this.getAll().forEach((function(e){return e.style.visibility=!0}))},e}();var x=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();const w=function(e){function n(t){var n,o,i=e.call(this)||this;return t.id=null!==(n=t.id)&&void 0!==n?n:null,t.style.margin=null!==(o=t.style.margin)&&void 0!==o?o:10,Object.assign(i,t),i.id=null,i}return x(n,e),n.prototype.updateOpacity=function(e){this.style.fillColor=t(this.style.fillColor,e),this.style.borderColor=t(this.style.borderColor,e)},n.prototype.isIntersectsWith=function(e){for(var t=2*this.style.margin+1,n=0,o=e;n<o.length;n++){var i=o[n];if(this.position.x+this.size.width+t>=i.position.x&&this.position.x-t<=i.position.x+i.size.width&&this.position.y+this.size.height+t>=i.position.y&&this.position.y-t<=i.position.y+i.size.height)return!0}return!1},n.prototype.renderAt=function(e){},n}(f);var L=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();const P=function(e){function t(t){var n=e.call(this,t)||this;return Object.assign(n,t),n.ports=new b({A:new m({letter:"A",parent:n,angle:180,r:4,x:n.position.x-n.style.margin,y:n.position.y+n.size.height/2}),B:new m({letter:"B",parent:n,angle:90,r:4,x:n.position.x+n.size.width/2,y:n.position.y-n.style.margin}),C:new m({letter:"C",parent:n,angle:0,r:4,x:n.position.x+n.size.width+n.style.margin,y:n.position.y+n.size.height/2}),D:new m({letter:"D",parent:n,angle:270,r:4,x:n.position.x+n.size.width/2,y:n.position.y+n.size.height+n.style.margin})}),n}return L(t,e),t.prototype.moveTo=function(e,t,n){var o=this,i=this.position.x-e,r=this.position.y-t;this.position.x=e,this.position.y=t;var s=n.filter((function(e){return e!==o}));this.isIntersectsWith(s)&&s.forEach((function(e){e.moveTo(e.position.x-i,e.position.y-r,n)})),this.ports.moveAll(-i,-r)},t.prototype.renderAt=function(e){e.fillStyle=this.style.fillColor,e.strokeStyle=this.style.borderColor,e.lineWidth=this.style.borderThickness,e.fillRect(this.position.x,this.position.y,this.size.width,this.size.height),this.style.borderThickness>0&&e.strokeRect(this.position.x,this.position.y,this.size.width,this.size.height),this.ports.getAll().forEach((function(t){t.renderAt(e)}))},t.prototype.hasConnection=function(){return this.ports.getAll().some((function(e){return!0===e.isBusy}))},Object.defineProperty(t.prototype,"left",{get:function(){return this.position.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.position.x+this.size.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.position.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.position.y+this.size.height},enumerable:!1,configurable:!0}),t}(w);var C=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();const T=function(e){function t(t){var n,o,i=e.call(this)||this;return i.type=t.type,i.classNames=t.classNames,i.label=t.label,i.settingsKey=t.settingsKey,i.valuesList=null!==(n=t.valuesList)&&void 0!==n?n:null,i.value=null!==(o=t.value)&&void 0!==o?o:null,i.body=i.create(),i}return C(t,e),t.prototype.create=function(){var e,t=this,n=document.createElement("label");this.classNames.length>0&&(e=n.classList).add.apply(e,this.classNames),n.classList.add("app-ui__item"),n.innerText=this.label+": ";var o=null;if("text"==this.type)(o=document.createElement("span")).innerHTML=null===this.value?'<span style="color: rgba(255, 255, 255, 0.3)">null</span>':"".concat(this.value);else if(("checkbox"===this.type||"dropdown-list"===this.type)&&this.settingsKey&&"string"==typeof this.settingsKey){var i=JSON.parse(localStorage.getItem(this.settingsKey));if(null===i&&localStorage.setItem(this.settingsKey,JSON.stringify(this.value)),null!==i&&(this.value=i),"checkbox"===this.type)(o=document.createElement("input")).setAttribute("type","checkbox"),o.checked=Boolean(this.value);else if("dropdown-list"===this.type&&null!==this.valuesList&&Array.isArray(this.valuesList)){o=document.createElement("select");for(var r=0,s=this.valuesList;r<s.length;r++){var a=s[r],l=document.createElement("option");l.innerText="".concat(a),a===this.value&&l.setAttribute("selected",""),o.appendChild(l)}}o&&o.addEventListener("change",(function(e){"checkbox"==t.type&&(t.value=e.target.checked),"dropdown-list"==t.type&&(t.value=o.value),localStorage.setItem(t.settingsKey,JSON.stringify(t.value)),t.dispatchEvent("change",{})}))}return o&&n.appendChild(o),n},t.prototype.updateValue=function(e){this.value=e,this.body.children[0].innerHTML="".concat(e)},t.prototype.replaceChild=function(e){this.body.replaceChild(e,this.body.children[0])},t.prototype.resetValue=function(){this.value=null;var e=document.createElement("span");e.innerHTML='<span style="color: rgba(255, 255, 255, 0.3)">null</span>',this.body.replaceChild(e,this.body.children[0])},t}(f);const S=function(e,t,n){var o=document.createElement("div");o.classList.add("app-ui__container"),o.style.width="".concat(t,"px"),o.style.height="".concat(n,"px");var i=document.createElement("div");i.classList.add("app-ui__container-inner"),document.querySelector(e).appendChild(o),this.root=o;var r=new T({type:"checkbox",label:"Render grid",classNames:[],value:!1,settingsKey:"renderGrid"}),s=new T({type:"dropdown-list",label:"Line style",classNames:["app-ui__dropdown-list"],valuesList:["solid","dashed","dots"],value:"solid",settingsKey:"lineStyle"}),a=new T({type:"dropdown-list",label:"Connection method",classNames:["app-ui__dropdown-list"],valuesList:["shortest path","straight line","orthogonal (elbow)"],value:"orthogonal (elbow)",settingsKey:"connectionMethod"}),l=new T({type:"checkbox",label:"Render pointer",classNames:[],value:!0,settingsKey:"renderLinePointer"}),c=new T({type:"text",label:"Mouse target",classNames:["app-ui__mouse-target-display"],value:null,settingsKey:null});c.body.style.width="93%",this.elements={renderGrid:r,renderLinePointer:l,lineStyle:s,connectionMethod:a,mouseTarget:c};var h=document.createElement("h3");h.innerText="[Dev UI]",h.classList.add("app-ui__title"),i.appendChild(h),i.appendChild(this.elements.renderGrid.body),i.appendChild(this.elements.renderLinePointer.body),i.appendChild(this.elements.lineStyle.body),i.appendChild(this.elements.connectionMethod.body),i.appendChild(this.elements.mouseTarget.body),o.appendChild(i)};var k=n(838),E="#app-root",A=new c(E,500,500),j=new S(E,350,500),O=new P({size:{width:100,height:80},position:{x:50,y:50},style:{fillColor:e("darkRed"),borderColor:e("brightRed"),borderThickness:2,margin:20}}),_=new P({size:{width:100,height:80},position:{x:350,y:350},style:{fillColor:e("darkBlue"),borderColor:e("brightBlue"),borderThickness:2,margin:20}});A.foreground.appendChild(O),A.foreground.appendChild(_),O.ports.getPort("C").connectTo(_.ports.getPort("A")),A.background.fill(e("carbon")),function(e,t){var n=e.canvas,o=n.width,i=n.height;e.strokeStyle=t.gridLineColor,e.lineWidth=t.gridLineThickness,e.beginPath();for(var r=0;r<=o;r+=t.gridSize)e.moveTo(r,0),e.lineTo(r,i);for(var s=0;s<=i;s+=t.gridSize)e.moveTo(0,s),e.lineTo(o,s);e.stroke()}(A.background.context,{gridSize:20,gridLineColor:"rgba(255, 255, 255, 0.025)",gridLineThickness:1});var N=function(){requestAnimationFrame(N),A.foreground.render()},B=function(e){return(0,k.json2html)({json:JSON.stringify(e),theme:"dracula",showTypeOnHover:!0})};N(),j.elements.connectionMethod.addEventListener("change",(function(){A.foreground.children.length>0&&A.foreground.children.find((function(e){return!0===e.hasConnection()})).ports.getAll().find((function(e){return!0===e.isBusy})).reconnect()})),A.foreground.children.forEach((function(e){e.addEventListener("mouseover",(function(t){e.updateOpacity(.35),A.foreground.body.style.cursor="pointer",j.elements.mouseTarget.replaceChild(B({class:"RectangleShape",id:t.target.id,x:t.target.position.x,y:t.target.position.y}))})),e.addEventListener("mouseout",(function(t){e.updateOpacity(1),A.foreground.body.style.cursor="initial",j.elements.mouseTarget.resetValue()})),e.addEventListener("drag",(function(t){e.updateOpacity(.1),e.moveTo(t.offset.x-e.size.width/2,t.offset.y-e.size.height/2,A.foreground.children),A.foreground.body.style.cursor="grab"})),e.addEventListener("dragend",(function(t){e.updateOpacity(.35),A.foreground.body.style.cursor="pointer"})),e.addEventListener("mouseup",(function(e){j.elements.mouseTarget.replaceChild(B({class:"RectangleShape",id:e.target.id,x:e.target.position.x,y:e.target.position.y}))})),e.ports.getAll().forEach((function(t){t.addEventListener("mouseover",(function(){e.hasConnection()&&!t.isBusy||(A.foreground.body.style.cursor="pointer",t.style.visibility=!0,t.style.fillColor="rgba(55, 55, 55, 1)",j.elements.mouseTarget.replaceChild(B({class:"Port",letter:t.letter,x:t.connectionPoint.point.x,y:t.connectionPoint.point.y,parent:t.parent.id,isBusy:t.isBusy,endPoint:!0===t.isBusy?t.endPoint.parent.id:null,role:!0===t.isBusy?t.role:null})))})),t.addEventListener("hoveron",(function(){e.hasConnection()&&t.isBusy&&(t.style.visibility=!0)})),t.addEventListener("hoveroff",(function(){e.hasConnection()&&t.isBusy&&(t.style.visibility=!1)})),t.addEventListener("mouseout",(function(){e.hasConnection()&&!t.isBusy||(A.foreground.body.style.cursor="initial",t.style.fillColor="rgba(25, 25, 25, 1)",j.elements.mouseTarget.resetValue())})),t.addEventListener("click",(function(){if(t.isBusy)t.parent.lastConnectionWith=t.disconnect().parent.id,e.ports.showAll();else if(!e.hasConnection()&&!t.isBusy&&t.parent.lastConnectionWith){var n=A.foreground.children.find((function(e){return e.id===t.parent.lastConnectionWith})).ports.getAll().find((function(e){return!0===e.isBusy}));t.connectTo(n),e.ports.hideAll()}}))}))})),A.processIntersectionsWithMouse(),console.log(A,j,O)})()})();