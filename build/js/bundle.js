(()=>{"use strict";function t(t){return{carbon:"rgba(14, 14, 14, 1)",darkRed:"rgba(38, 12, 12, 1)",brightRed:"rgba(114, 6, 6, 1)",darkBlue:"rgba(12, 16, 38, 1)",brightBlue:"rgba(9, 12, 104, 1)",darkGreen:"rgba(12, 38, 12, 1)",brightGreen:"rgba(6, 114, 6, 1)"}[t]}function e(t,e){return e=Math.max(0,Math.min(e,1)),t.split(", ").map((function(t,o){return 3==o&&(t=e+")"),t})).join(", ")}var o=function(){function t(t,e){this.uniqueIDs=new Set,this.parent=t;var o=document.createElement("canvas");if(o.width=this.parent.width,o.height=this.parent.height,o.classList.add(e),this.body=o,this.context=o.getContext("2d"),!this.context)throw new Error("Failed to get 2D drawing context.");this.children=[]}return t.prototype.getUniqueID=function(){var t;do{t=Math.floor(1e4*Math.random())+1}while(this.uniqueIDs.has(t));return this.uniqueIDs.add(t),t},t.prototype.fill=function(t){this.context.fillStyle=t,this.context.fillRect(0,0,this.parent.width,this.parent.height)},t.prototype.appendChild=function(t){t.id=this.getUniqueID(),this.children.push(t)},t.prototype.render=function(){this.context.clearRect(0,0,this.parent.width,this.parent.height);for(var t=0,e=this.children;t<e.length;t++)e[t].renderAt(this.context)},t}(),n=function(){function t(t,e,n){this.width=e,this.height=n,this.background=new o(this,"app-canvas__background"),this.foreground=new o(this,"app-canvas__foreground");var i=document.createElement("div");i.classList.add("app-canvas__container"),i.appendChild(this.background.body),i.appendChild(this.foreground.body),i.style.width="".concat(e,"px"),i.style.height="".concat(n,"px"),document.querySelector(t).appendChild(i)}return t.prototype.addEventListener=function(t,e){this.foreground.body.addEventListener(t,(function(t){e(t)}))},t.prototype.processIntersectionsWithMouse=function(){var t=this;this.addEventListener("mousedown",(function(e){t.isMousePressed=!0})),this.addEventListener("mouseup",(function(e){t.isMousePressed=!1})),this.addEventListener("mousemove",(function(e){if(e instanceof MouseEvent)for(var o=function(t,e){var o=t.getBoundingClientRect();return{x:e.clientX-o.left,y:e.clientY-o.top}}(t.foreground.body,e),n={x:0,y:0},i=0,r=t.foreground.children;i<r.length;i++){var s=r[i];if(o.x>=s.position.x&&o.x<=s.position.x+s.size.width&&o.y>=s.position.y&&o.y<=s.position.y+s.size.height){var a={target:s,mousePosition:o};s.dispatchEvent("mousemove",a),s.eventStates.mousemove=!0,s.eventStates.mouseover||(s.dispatchEvent("mouseover",a),s.eventStates.mouseover=!0,s.eventStates.mouseout=!1),t.isMousePressed&&(s.dispatchEvent("drag",{eventData:a,offset:{x:o.x-n.x,y:o.y-n.y}}),n=o,s.eventStates.drag=!0),!t.isMousePressed&&s.eventStates.drag&&(s.dispatchEvent("dragend",a),s.eventStates.drag=!1)}else s.eventStates.mouseout||(s.dispatchEvent("mouseout",{target:s}),s.eventStates.mouseout=!0,s.eventStates.mouseover=!1),s.eventStates.mousemove=!1}}))},t}();const i=n;var r,s=function(){function t(){this.events={}}return t.prototype.addEventListener=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},t.prototype.dispatchEvent=function(t,e){this.events[t]&&this.events[t].forEach((function(t){return t(e)}))},t}(),a=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});const u=function(t){function o(e){var o=t.call(this)||this;return Object.assign(o,e),o.id=null,o.eventStates={mouseout:!1,mouseover:!1,mouseup:!0,mousedown:!1,mousemove:!1,drag:!1},o}return a(o,t),o.prototype.updateOpacity=function(t){this.style.fillColor=e(this.style.fillColor,t),this.style.borderColor=e(this.style.borderColor,t)},o.prototype.isIntersectsWith=function(t){for(var e=0,o=t;e<o.length;e++){var n=o[e];if(this.id!==n.id&&this.position.x+this.size.width+2>=n.position.x&&this.position.x-2<=n.position.x+n.size.width&&this.position.y+this.size.height+2>=n.position.y&&this.position.y-2<=n.position.y+n.size.height)return!0}return!1},o.prototype.renderAt=function(t){},o}(s);var h=function(){var t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},t(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();const d=function(t){function e(e){var o=t.call(this,e)||this;return Object.assign(o,e),o}return h(e,t),e.prototype.renderAt=function(t){t.fillStyle=this.style.fillColor,t.strokeStyle=this.style.borderColor,t.lineWidth=this.style.borderThickness,t.fillRect(this.position.x,this.position.y,this.size.width,this.size.height),this.style.borderThickness>0&&t.strokeRect(this.position.x,this.position.y,this.size.width,this.size.height)},e}(u);var c=new i("#app-root",500,500),p=new d({size:{width:100,height:80},position:{x:30,y:10},style:{fillColor:t("darkRed"),borderColor:t("brightRed"),borderThickness:2}}),l=new d({size:{width:100,height:80},position:{x:230,y:110},style:{fillColor:t("darkBlue"),borderColor:t("brightBlue"),borderThickness:2}});c.foreground.appendChild(p),c.foreground.appendChild(l),c.background.fill(t("carbon")),function(t,e){var o=t.canvas,n=o.width,i=o.height;t.strokeStyle=e.gridLineColor,t.lineWidth=e.gridLineThickness,t.beginPath();for(var r=0;r<=n;r+=e.gridSize)t.moveTo(r,0),t.lineTo(r,i);for(var s=0;s<=i;s+=e.gridSize)t.moveTo(0,s),t.lineTo(n,s);t.stroke()}(c.background.context,{gridSize:20,gridLineColor:"rgba(255, 255, 255, 0.025)",gridLineThickness:1});var f=function(){requestAnimationFrame(f),c.foreground.render()};f(),c.foreground.children.forEach((function(t){t.addEventListener("mouseover",(function(e){t.updateOpacity(.35),c.foreground.body.style.cursor="pointer"})),t.addEventListener("mouseout",(function(e){t.updateOpacity(1),c.foreground.body.style.cursor="initial"})),t.addEventListener("drag",(function(e){t.updateOpacity(.1);var o={x:t.position.x,y:t.position.y};t.position.x=e.offset.x-t.size.width/2,t.position.y=e.offset.y-t.size.height/2,t.isIntersectsWith(c.foreground.children)&&(t.position.x=o.x,t.position.y=o.y),c.foreground.body.style.cursor="grab"})),t.addEventListener("dragend",(function(e){t.updateOpacity(.35),c.foreground.body.style.cursor="pointer"}))})),c.processIntersectionsWithMouse(),console.log(c,p)})();